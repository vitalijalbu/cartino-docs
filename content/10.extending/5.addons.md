---
title: Building Addons
description: Create and distribute reusable packages for Cartino.
---

# Building Addons

Create reusable packages that extend Cartino's functionality and can be shared with the community.

## Package Structure

A typical Cartino addon structure:

```
cartino-subscriptions/
├── src/
│   ├── SubscriptionServiceProvider.php
│   ├── Models/
│   │   ├── Subscription.php
│   │   └── Plan.php
│   ├── Http/
│   │   ├── Controllers/
│   │   └── Middleware/
│   ├── Events/
│   ├── Listeners/
│   └── Services/
├── database/
│   └── migrations/
├── resources/
│   ├── js/
│   │   ├── components/
│   │   └── pages/
│   └── views/
├── routes/
│   ├── web.php
│   └── api.php
├── tests/
├── composer.json
├── package.json
└── README.md
```

## Creating a Package

### 1. Initialize Package

```bash
mkdir cartino-subscriptions
cd cartino-subscriptions
composer init
```

### 2. Composer Configuration

```json
{
  "name": "your-vendor/cartino-subscriptions",
  "description": "Subscription management for Cartino",
  "type": "library",
  "keywords": ["cartino", "subscriptions", "e-commerce"],
  "license": "MIT",
  "authors": [
    {
      "name": "Your Name",
      "email": "your@email.com"
    }
  ],
  "require": {
    "php": "^8.2",
    "laravel/framework": "^11.0",
    "cartino/cartino": "^1.0"
  },
  "require-dev": {
    "orchestra/testbench": "^9.0",
    "phpunit/phpunit": "^10.0"
  },
  "autoload": {
    "psr-4": {
      "YourVendor\\Subscriptions\\": "src/"
    }
  },
  "autoload-dev": {
    "psr-4": {
      "YourVendor\\Subscriptions\\Tests\\": "tests/"
    }
  },
  "extra": {
    "laravel": {
      "providers": [
        "YourVendor\\Subscriptions\\SubscriptionServiceProvider"
      ]
    },
    "cartino": {
      "name": "Subscriptions",
      "description": "Subscription management addon",
      "version": "1.0.0"
    }
  }
}
```

### 3. Service Provider

```php
// src/SubscriptionServiceProvider.php
namespace YourVendor\Subscriptions;

use Illuminate\Support\ServiceProvider;

class SubscriptionServiceProvider extends ServiceProvider
{
    public function register(): void
    {
        // Merge config
        $this->mergeConfigFrom(
            __DIR__.'/../config/subscriptions.php',
            'subscriptions'
        );

        // Register services
        $this->app->singleton(SubscriptionService::class);
    }

    public function boot(): void
    {
        // Publish config
        $this->publishes([
            __DIR__.'/../config/subscriptions.php' => config_path('subscriptions.php'),
        ], 'subscriptions-config');

        // Publish migrations
        $this->publishes([
            __DIR__.'/../database/migrations' => database_path('migrations'),
        ], 'subscriptions-migrations');

        // Load migrations
        $this->loadMigrationsFrom(__DIR__.'/../database/migrations');

        // Load routes
        $this->loadRoutesFrom(__DIR__.'/../routes/web.php');
        $this->loadRoutesFrom(__DIR__.'/../routes/api.php');

        // Load views
        $this->loadViewsFrom(__DIR__.'/../resources/views', 'subscriptions');

        // Publish views
        $this->publishes([
            __DIR__.'/../resources/views' => resource_path('views/vendor/subscriptions'),
        ], 'subscriptions-views');

        // Publish assets
        $this->publishes([
            __DIR__.'/../resources/js' => resource_path('js/vendor/subscriptions'),
        ], 'subscriptions-assets');

        // Register commands
        if ($this->app->runningInConsole()) {
            $this->commands([
                Commands\CheckExpiredSubscriptions::class,
            ]);
        }

        // Register event listeners
        $this->bootEvents();
    }

    protected function bootEvents(): void
    {
        Event::listen(
            \Cartino\Events\Order\OrderCreated::class,
            \YourVendor\Subscriptions\Listeners\CreateSubscriptionFromOrder::class
        );
    }
}
```

## Package Features

### Models

```php
// src/Models/Subscription.php
namespace YourVendor\Subscriptions\Models;

use Illuminate\Database\Eloquent\Model;
use Cartino\Models\Customer;

class Subscription extends Model
{
    protected $fillable = [
        'customer_id',
        'plan_id',
        'status',
        'started_at',
        'ends_at',
    ];

    protected $casts = [
        'started_at' => 'datetime',
        'ends_at' => 'datetime',
    ];

    public function customer()
    {
        return $this->belongsTo(Customer::class);
    }

    public function plan()
    {
        return $this->belongsTo(Plan::class);
    }
}
```

### Configuration

```php
// config/subscriptions.php
return [
    'table_prefix' => 'subscription_',
    
    'trial_days' => 14,
    
    'billing' => [
        'provider' => 'stripe',
        'key' => env('SUBSCRIPTION_BILLING_KEY'),
    ],
    
    'notifications' => [
        'expiring_soon_days' => 7,
        'send_renewal_reminders' => true,
    ],
];
```

### Migrations

```php
// database/migrations/2025_01_01_000000_create_subscriptions_table.php
use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

return new class extends Migration
{
    public function up(): void
    {
        Schema::create(config('subscriptions.table_prefix').'subscriptions', function (Blueprint $table) {
            $table->id();
            $table->foreignId('customer_id')->constrained()->cascadeOnDelete();
            $table->foreignId('plan_id')->constrained(config('subscriptions.table_prefix').'plans');
            $table->string('status')->default('active');
            $table->timestamp('started_at');
            $table->timestamp('ends_at')->nullable();
            $table->timestamp('trial_ends_at')->nullable();
            $table->json('metadata')->nullable();
            $table->timestamps();
        });
    }

    public function down(): void
    {
        Schema::dropIfExists(config('subscriptions.table_prefix').'subscriptions');
    }
};
```

### Routes

```php
// routes/api.php
use Illuminate\Support\Facades\Route;
use YourVendor\Subscriptions\Http\Controllers\Api\SubscriptionController;

Route::prefix('api/subscriptions')
    ->middleware(['api', 'auth:sanctum'])
    ->group(function () {
        Route::get('/', [SubscriptionController::class, 'index']);
        Route::post('/', [SubscriptionController::class, 'store']);
        Route::get('/{subscription}', [SubscriptionController::class, 'show']);
        Route::post('/{subscription}/cancel', [SubscriptionController::class, 'cancel']);
    });
```

### Frontend Components

```vue
<!-- resources/js/components/SubscriptionManager.vue -->
<template>
  <CCard>
    <CCardHeader>
      <CCardTitle>Subscriptions</CCardTitle>
      <template #actions>
        <CButton @click="createSubscription">
          New Subscription
        </CButton>
      </template>
    </CCardHeader>
    
    <CCardContent>
      <CTable
        :columns="columns"
        :data="subscriptions"
        :loading="loading"
      />
    </CCardContent>
  </CCard>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'

const subscriptions = ref([])
const loading = ref(false)

const loadSubscriptions = async () => {
  loading.value = true
  try {
    const response = await fetch('/api/subscriptions')
    subscriptions.value = await response.json()
  } finally {
    loading.value = false
  }
}

onMounted(loadSubscriptions)
</script>
```

## Testing

### Test Setup

```php
// tests/TestCase.php
namespace YourVendor\Subscriptions\Tests;

use Orchestra\Testbench\TestCase as Orchestra;
use YourVendor\Subscriptions\SubscriptionServiceProvider;

abstract class TestCase extends Orchestra
{
    protected function getPackageProviders($app): array
    {
        return [
            SubscriptionServiceProvider::class,
        ];
    }

    protected function getEnvironmentSetUp($app): void
    {
        $app['config']->set('database.default', 'testing');
        $app['config']->set('database.connections.testing', [
            'driver' => 'sqlite',
            'database' => ':memory:',
        ]);
    }
}
```

### Feature Tests

```php
// tests/Feature/SubscriptionTest.php
namespace YourVendor\Subscriptions\Tests\Feature;

use YourVendor\Subscriptions\Tests\TestCase;
use YourVendor\Subscriptions\Models\Subscription;

class SubscriptionTest extends TestCase
{
    public function test_can_create_subscription(): void
    {
        $subscription = Subscription::factory()->create();

        $this->assertDatabaseHas('subscriptions', [
            'id' => $subscription->id,
        ]);
    }

    public function test_can_cancel_subscription(): void
    {
        $subscription = Subscription::factory()->create();
        
        $subscription->cancel();

        $this->assertEquals('cancelled', $subscription->status);
    }
}
```

## Publishing Package

### 1. Documentation

Create comprehensive README.md:

```markdown
# Cartino Subscriptions

Subscription management addon for Cartino.

## Installation

```bash
composer require your-vendor/cartino-subscriptions
```

## Configuration

Publish config:

```bash
php artisan vendor:publish --tag=subscriptions-config
```

## Usage

Create subscription:

```php
use YourVendor\Subscriptions\Models\Subscription;

$subscription = Subscription::create([...]);
```
```

### 2. Versioning

Follow semantic versioning:
- **1.0.0** - Initial release
- **1.1.0** - New features
- **1.0.1** - Bug fixes
- **2.0.0** - Breaking changes

### 3. Release on Packagist

```bash
# Tag release
git tag -a v1.0.0 -m "Initial release"
git push origin v1.0.0

# Submit to Packagist
# https://packagist.org/packages/submit
```

### 4. GitHub

Create releases on GitHub with changelog:

```markdown
## v1.0.0

### Added
- Subscription management
- Trial period support
- Automatic billing

### Fixed
- Date timezone issues
```

## Best Practices

::callout{icon="i-lucide-check-circle" color="green"}
**Package Best Practices**
- Follow PSR-12 coding standards
- Provide comprehensive tests (>80% coverage)
- Write detailed documentation
- Use semantic versioning
- Provide upgrade guides for breaking changes
- Support latest Laravel and Cartino versions
::

## Package Distribution

### Composer Installation

```bash
composer require your-vendor/cartino-subscriptions
```

### Publishing Assets

```bash
php artisan vendor:publish --provider="YourVendor\Subscriptions\SubscriptionServiceProvider"

# Or specific tags
php artisan vendor:publish --tag=subscriptions-config
php artisan vendor:publish --tag=subscriptions-migrations
```

## Example Addons

Browse existing Cartino addons for inspiration:

::u-button
---
to: https://github.com/topics/cartino-addon
target: _blank
icon: i-simple-icons-github
---
Browse Cartino Addons
::

## Next Steps

- Share your addon on [GitHub](https://github.com)
- Submit to [Packagist](https://packagist.org)
- Announce in Cartino community
- Maintain and update regularly
